language: ruby
rvm:
  - 2.3.3

install:
  - bundle install
  - gem install jekyll
  - gem install jekyll-paginate
  - gem install redcarpet
  - gem install pygments.rb

branches:
  only:
    - master

notifications:
  email:
    recipients:
      - timlockridge@gmail.com
    on_success: always
    on_failure: always

script:
  - chmod +x _scripts/build.sh
  - _scripts/build.sh

after_success:
  - export SSHPASS=$PASSWORD

deploy:
  - provider: script
    script: cd _site
  - provider: script
    script: sshpass -e scp -r . $USERNAME@$HOST:/home/timlockridge/mainwebsite_html

sudo: false
addons:
  apt:
    packages:
      - sshpass
